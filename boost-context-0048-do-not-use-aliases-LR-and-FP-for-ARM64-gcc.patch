From 6e2a2b4b309f4f98ece77edc8746fa683a2e05d8 Mon Sep 17 00:00:00 2001
From: Oliver Kowalke <oliver.kowalke@gmx.de>
Date: Wed, 25 Feb 2015 19:49:30 +0100
Subject: [PATCH 48/54] do not use aliases LR and FP for ARM64/gcc

---
 src/asm/jump_arm64_aapcs_elf_gas.S | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

diff --git a/libs/context/src/asm/jump_arm64_aapcs_elf_gas.S b/libs/context/src/asm/jump_arm64_aapcs_elf_gas.S
index 889008f..09bd7b5 100644
--- a/libs/context/src/asm/jump_arm64_aapcs_elf_gas.S
+++ b/libs/context/src/asm/jump_arm64_aapcs_elf_gas.S
@@ -83,10 +83,10 @@ jump_fcontext:
     stp  x23, x24, [sp, #0x60]
     stp  x25, x26, [sp, #0x70]
     stp  x27, x28, [sp, #0x80]
-    stp  fp,  lr,  [sp, #0x90]
+    stp  x29, x30, [sp, #0x90]
 
     # save LR as PC
-    str  lr, [sp, #0xa0]
+    str  x30, [sp, #0xa0]
 
     # store RSP (pointing to context-data) in first argument (x0).
     # STR cannot have sp as a target register
@@ -113,7 +113,7 @@ jump_fcontext:
     ldp  x23, x24, [sp, #0x60]
     ldp  x25, x26, [sp, #0x70]
     ldp  x27, x28, [sp, #0x80]
-    ldp  fp,  lr,  [sp, #0x90]
+    ldp  x29, x30, [sp, #0x90]
 
     # use third arg as return value after jump
     # and as first arg in context function
-- 
2.3.5

